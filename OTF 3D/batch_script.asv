% Run sequence of scripts to make object, make illumination and imaging
% CSFs, and generate the OTF
load_params

object = make_complex_object(p);

phaseTF = generate_phase_tf(p);


objectFiltered = imag(ifftn(fftn(object).*ifftshift(phaseTF)));

%%
toShow = throughFocusAndAxialSlice(objectFiltered
toShow = ([objectFiltered(:,:,end/2+1) , squeeze(objectFiltered(end/2+1,:,:))' ]);
toShow = (toShow-min(toShow(:)))./(max(toShow(:))-min(toShow(:)));
imshow(toShow)